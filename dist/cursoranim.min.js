/*!
 * CursorAnim.js
 * https://github.com/TeKrop/cursoranim
 *
 * Copyright 2015 Valentin PORCHET
 * Released under the MIT license
 */
var CursorAnim=function(){"use strict";var mousePosition={x:0,y:0},isDragging=!1,draggedElement=null,lastTargettedElement=null,animating=!1,correctEvents=["move","click","drag","drop","wait","type"],cursor=null,overlay=null,animationDuration=1e3,animationEasing="easeInOutCubic",animationCursor="data:image/gif;base64,R0lGODlhDwAWAMIEAAAAADk5OUJCQs7Ozv///////////////yH5BAEKAAcALAAAAAAPABYAAANEeLrcF2A4F4aQc1VSs9rE5YEhRg1EWk5kKjata36oqr60beOxAPyRXGkFQ/mMM5roQtQED0wcjRFNNqoeBdaz5T6zjgQAOw==",events=null;$(document).on("mousemove",function(t){null==t.relatedTarget&&(mousePosition={x:t.pageX,y:t.pageY})});var onDragCustomEvent=function(t,e){e.position.left=cursor.offset().left-draggedElement.width()/2,e.position.top=cursor.offset().top-draggedElement.height()/2},loadProcess=function(t){var e=null,n=null;if("string"==typeof t)if(-1!==t.indexOf(".json",t.length-5))$.ajax({url:t,async:!1,dataType:"json",mimeType:"application/json",success:function(t){n=t}});else try{n=JSON.parse(t)}catch(o){throw console.error(o.name+" : "+o.message),new TypeError("Your string doesn't contain valid json data.")}else{if("Array"!=typeof t)throw console.log(typeof t),new TypeError("CursorAnim data must be in json format, either by filename, string or array.");n=t}return e=convertDataToEvents(n)},convertDataToEvents=function(jsonData){var actions=[];actions.push(hideCursor);for(var i=0;i<jsonData.length;i++)if("action"in jsonData[i])if(eval("typeof "+jsonData[i].action+" === 'function'")&&correctEvents.indexOf(jsonData[i].action)>-1){var functionContent="return CursorAnim."+jsonData[i].action+"(";functionContent+="options"in jsonData[i]?JSON.stringify(jsonData[i].options)+", ":"{}, ",functionContent+="callback);",actions.push(new Function("callback",functionContent))}else console.warn("The event '"+jsonData[i].action+"' doesn't exist. Skipping it.");else console.warn("Incorrect event : no action was provided. Skipping it.");return actions.push(returnToMousePosition,showCursor),actions},hideCursor=function(t){$("body").css("cursor","none"),$("body").append('<img id="cursorAnim" alt="cursor animation" src="'+animationCursor+'"/>'),$("body").append('<div id="overlayCursorAnim"></div>'),cursor=$("#cursorAnim"),overlay=$("#overlayCursorAnim"),cursor.css({top:mousePosition.y,left:mousePosition.x}),t()},showCursor=function(t){$("body").css({cursor:"default"}),cursor.remove(),overlay.remove(),isDragging?drop({},t):t()},returnToMousePosition=function(t){cursor.animate({left:mousePosition.x,top:mousePosition.y},{duration:animationDuration,specialEasing:{left:animationEasing,top:animationEasing},step:function(t,e){e.end="left"===e.prop?mousePosition.x:mousePosition.y},complete:t})},move=function(t,e){var n=parseInt(t.duration)||animationDuration,o=parseInt(t.easing)||animationEasing,a=cursor.offset().left,i=cursor.offset().top,r=null,s=null;if("selector"in t||"position"in t){if("selector"in t){if(lastTargettedElement=$(t.selector),!lastTargettedElement.length)throw showCursor(e),new ReferenceError("The object "+t.selector+" targetted by the move function doesn't exists.");r=lastTargettedElement.offset().left+lastTargettedElement.outerWidth()/2,s=lastTargettedElement.offset().top+lastTargettedElement.outerHeight()/2}else{var l=document.elementFromPoint(parseInt(t.position.x),parseInt(t.position.y));lastTargettedElement=null===l?lastTargettedElement:$(l),r=t.position.x,s=t.position.y}cursor.animate({left:r,top:s},{duration:n,specialEasing:{left:o,top:o},step:function(t,e){isDragging===!0&&("left"==e.prop?(draggedElement.simulate("drag",{dx:t-a,dy:0}),a=t):(draggedElement.simulate("drag",{dx:0,dy:t-i}),i=t))},complete:e})}else console.warn("Didn't provide CSS selector or position for cursor to move on. Skipping."),e()},click=function(t,e){lastTargettedElement.click(),e()},drag=function(t,e){isDragging=!0,draggedElement=lastTargettedElement,"clone"===draggedElement.draggable("option").helper&&draggedElement.bind("drag",onDragCustomEvent),e()},drop=function(t,e){"clone"===draggedElement.draggable("option").helper&&draggedElement.unbind("drag"),lastTargettedElement.simulate("drop",{target:draggedElement}),isDragging=!1,draggedElement=null,e()},wait=function(t,e){var n=parseInt(t.duration)||animationDuration;setTimeout(e,n)},type=function(t,e){lastTargettedElement.is("input:text")||lastTargettedElement.is("textarea")?"strings"in t?lastTargettedElement.typed({strings:t.strings,typeSpeed:t.typeSpeed||0,startDelay:t.startDelay||0,backSpeed:t.backSpeed||0,backDelay:t.backDelay||500,contentType:"text",callback:e}):(console.warn("type function was called without text. Skipping."),e()):(console.warn("the targetted div isn't an input or textarea. Skipping."),e())};return{setOptions:function(t){if((null===t||"undefined"==typeof t)&&(t={}),"defaultDuration"in t&&(animationDuration=0/0!==parseInt(t.defaultDuration)?t.defaultDuration:animationDuration),"defaultEasing"in t&&(animationEasing=void 0!==$.easing[t.defaultEasing]?t.defaultEasing:animationEasing),"cursor"in t&&(animationCursor="string"==typeof t.cursor?t.cursor:animationCursor),"data"in t)try{events=loadProcess(t.data)}catch(e){console.error(e.name+" : "+e.message),events=null}},load:function(t){if(null===t||"undefined"==typeof t)console.warn("No data was passed, keeping the old data (null if just initialized)");else try{events=loadProcess(t)}catch(e){console.error(e.name+" : "+e.message)}},start:function(){null!==events&&events!=={}?(animating=!0,async.series(events,function(t){console.log(null===t?"animation complete":"Error : "+t),animating=!1})):console.warn("start was called but the list of events was empty or inexistant.")},pause:function(){},resume:function(){},stop:function(){},move:move,click:click,drag:drag,drop:drop,wait:wait,type:type}}();