/*!
 * CursorAnim.js
 * https://github.com/TeKrop/cursoranim
 *
 * Copyright 2015 Valentin PORCHET
 * Released under the MIT license
 */
var CursorAnim=function(){"use strict";var mousePosition={x:0,y:0},isDragging=!1,draggedElement=null,lastTargettedElement=null,animating=!1,correctEvents=["move","click","drag","drop","wait"],cursor=null,overlay=null,animationDuration=1e3,animationEasing="easeInOutCubic",animationCursor="data:image/gif;base64,R0lGODlhDwAWAMIEAAAAADk5OUJCQs7Ozv///////////////yH5BAEKAAcALAAAAAAPABYAAANEeLrcF2A4F4aQc1VSs9rE5YEhRg1EWk5kKjata36oqr60beOxAPyRXGkFQ/mMM5roQtQED0wcjRFNNqoeBdaz5T6zjgQAOw==",events=null;$(document).on("mousemove",function(n){null==n.relatedTarget&&(mousePosition={x:n.pageX,y:n.pageY})});var onDragCustomEvent=function(n,e){e.position.left=cursor.offset().left-draggedElement.width()/2,e.position.top=cursor.offset().top-draggedElement.height()/2},loadProcess=function(n){var e=null,t=null;if("string"==typeof n)if(-1!==n.indexOf(".json",n.length-5))$.ajax({url:n,async:!1,dataType:"json",mimeType:"application/json",success:function(n){t=n}});else try{t=JSON.parse(n)}catch(o){throw console.error(o.name+" : "+o.message),new TypeError("Your string doesn't contain valid json data.")}else{if("Array"!=typeof n)throw console.log(typeof n),new TypeError("CursorAnim data must be in json format, either by filename, string or array.");t=n}return e=convertDataToEvents(t)},convertDataToEvents=function(jsonData){var actions=[];actions.push(hideCursor);for(var i=0;i<jsonData.length;i++)if("action"in jsonData[i])if(eval("typeof "+jsonData[i].action+" === 'function'")&&correctEvents.indexOf(jsonData[i].action)>-1){var functionContent="return CursorAnim."+jsonData[i].action+"(";functionContent+="options"in jsonData[i]?JSON.stringify(jsonData[i].options)+", ":"{}, ",functionContent+="callback);",actions.push(new Function("callback",functionContent))}else console.warn("The event '"+jsonData[i].action+"' doesn't exist. Skipping it.");else console.warn("Incorrect event : no action was provided. Skipping it.");return actions.push(returnToMousePosition,showCursor),actions},hideCursor=function(n){$("body").css("cursor","none"),$("body").append('<img id="cursorAnim" alt="cursor animation" src="'+animationCursor+'"/>'),$("body").append('<div id="overlayCursorAnim"></div>'),cursor=$("#cursorAnim"),overlay=$("#overlayCursorAnim"),cursor.css({top:mousePosition.y,left:mousePosition.x}),n()},showCursor=function(n){$("body").css({cursor:"default"}),cursor.remove(),overlay.remove(),isDragging?drop({},n):n()},returnToMousePosition=function(n){cursor.animate({left:mousePosition.x,top:mousePosition.y},{duration:animationDuration,specialEasing:{left:animationEasing,top:animationEasing},step:function(n,e){e.end="left"===e.prop?mousePosition.x:mousePosition.y},complete:n})},move=function(n,e){var t=parseInt(n.duration)||animationDuration,o=parseInt(n.easing)||animationEasing,a=cursor.offset().left,i=cursor.offset().top,r=null,s=null;if("selector"in n||"position"in n){if("selector"in n){if(lastTargettedElement=$(n.selector),!lastTargettedElement.length)throw showCursor(e),new ReferenceError("The object "+n.selector+" targetted by the move function doesn't exists.");r=lastTargettedElement.offset().left+lastTargettedElement.outerWidth()/2,s=lastTargettedElement.offset().top+lastTargettedElement.outerHeight()/2}else{var l=document.elementFromPoint(parseInt(n.position.x),parseInt(n.position.y));lastTargettedElement=null===l?lastTargettedElement:$(l),r=n.position.x,s=n.position.y}cursor.animate({left:r,top:s},{duration:t,specialEasing:{left:o,top:o},step:function(n,e){isDragging===!0&&("left"==e.prop?(draggedElement.simulate("drag",{dx:n-a,dy:0}),a=n):(draggedElement.simulate("drag",{dx:0,dy:n-i}),i=n))},complete:e})}else console.warn("Didn't provide CSS selector or position for cursor to move on. Skipping."),e()},click=function(n,e){lastTargettedElement.click(),e()},drag=function(n,e){isDragging=!0,draggedElement=lastTargettedElement,"clone"===draggedElement.draggable("option").helper&&draggedElement.bind("drag",onDragCustomEvent),e()},drop=function(n,e){"clone"===draggedElement.draggable("option").helper&&draggedElement.unbind("drag"),lastTargettedElement.simulate("drop",{target:draggedElement}),isDragging=!1,draggedElement=null,e()},wait=function(n,e){var t=parseInt(n.duration)||animationDuration;setTimeout(e,t)};return{setOptions:function(n){if((null===n||"undefined"==typeof n)&&(n={}),"defaultDuration"in n&&(animationDuration=0/0!==parseInt(n.defaultDuration)?n.defaultDuration:animationDuration),"defaultEasing"in n&&(animationEasing=void 0!==$.easing[n.defaultEasing]?n.defaultEasing:animationEasing),"cursor"in n&&(animationCursor="string"==typeof n.cursor?n.cursor:animationCursor),"data"in n)try{events=loadProcess(n.data)}catch(e){console.error(e.name+" : "+e.message),events=null}},load:function(n){if(null===n||"undefined"==typeof n)console.warn("No data was passed, keeping the old data (null if just initialized)");else try{events=loadProcess(n)}catch(e){console.error(e.name+" : "+e.message)}},start:function(){null!==events&&events!=={}?(animating=!0,async.series(events,function(n){console.log(null===n?"animation complete":"Error : "+n),animating=!1})):console.warn("start was called but the list of events was empty or inexistant.")},pause:function(){},resume:function(){},stop:function(){},move:move,click:click,drag:drag,drop:drop,wait:wait}}();